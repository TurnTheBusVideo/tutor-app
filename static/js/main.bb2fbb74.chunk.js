(this["webpackJsonptutor-app"]=this["webpackJsonptutor-app"]||[]).push([[0],{480:function(e,t,a){e.exports=a(992)},484:function(e,t,a){},857:function(e,t){},859:function(e,t){},870:function(e,t){},872:function(e,t){},899:function(e,t){},901:function(e,t){},902:function(e,t){},907:function(e,t){},909:function(e,t){},928:function(e,t){},940:function(e,t){},943:function(e,t){},967:function(e,t,a){},992:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(25),o=a.n(l),i=(a(484),a(128)),c=a(468),s={cognito:{userPoolId:"ap-south-1_goMJyvOwY",userPoolWebClientId:"6pvgee8erngn4d70buf5ulnefs",region:"ap-south-1"},api:{invokeUrl:"https://1bb73f90n5.execute-api.ap-south-1.amazonaws.com/test"},videoBucket:"test-turnthebus-upload"},u=a(39),d=a(10),m=(a(234),a(29)),f=a(20),v=a(204),p=a(111),b=a(92),g=a(116),E=a(152),h=(a(485),a(447)),O=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:"https://turnthebus.org/images/turn-the-bus-logo.png",alt:"Seattle Public Library Logo"}))},j=a(203),y=a(79),k=a(40),S=a.n(k),N={},w=function(e){k.remove("user-session"),k.set("user-session",e,{expires:14})},P=function(){var e=k.get("user-session");if(void 0===e)return N;try{return JSON.parse(e)}catch(t){return console.error("Corrupted session cookie"),k.remove("user-session"),N}},C=(r.a.createContext(P()),{getSession:function(){return P()},setSession:function(e){return w(e)},getSessionProp:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return C.isAuthenticated()&&-1!=Object.keys(C.getSession()).indexOf(e)?C.getSession()[e]:t},setSessionProp:function(e,t){C.isAuthenticated()&&C.setSession(Object(y.a)(Object(y.a)({},C.getSession()),{},Object(j.a)({},e,t)))},isAuthenticated:function(){var e;return(null===(e=C.getSession())||void 0===e?void 0:e.email)||!1},isAdmin:function(){return C.getSessionProp("isAdmin")},isTutor:function(){return C.getSessionProp("isTutor",!0)},getAuthToken:function(){return C.getSessionProp("authToken")},getUsername:function(){return C.getSessionProp("email")},getName:function(){return C.getSessionProp("name")}}),x=C,T=a(38),F=a(112),L=(a(448),a(449),a(471),a(469),function(e){return r.a.createElement(v.a,{className:"h-100"},r.a.createElement(p.a,{className:"h-100"},r.a.createElement(T.a,null),r.a.createElement(T.a,{xs:12,lg:6,className:"align-self-center"},e),r.a.createElement(T.a,null)))}),I=a(450),B=function(){var e=x.getSessionProp("show-welcome-banner",!0),t=Object(n.useState)(e),a=Object(d.a)(t,2),l=a[0],o=a[1];return l&&r.a.createElement(I.a,{fluid:!0,className:"welcome-banner"},r.a.createElement(F.a,{"aria-label":"dismiss banner",className:"close-btn",onClick:function(){x.setSessionProp("show-welcome-banner",!1),o(!1)},variant:"outline-dark",size:"sm"},"Dismiss"),L(r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"display-4"},"\u0938\u094d\u0935\u093e\u0917\u0924 \u0939\u0948"),r.a.createElement("p",{className:"lead"},"\u0928\u092e\u0938\u094d\u0924\u0947 \u0926\u094b\u0938\u094d\u0924\u094b\u0902\u0964 \u091f\u0930\u094d\u0928 \u0926 \u092c\u0938 \u0915\u0947 \u0938\u093e\u0925 \u0911\u0928\u0932\u093e\u0907\u0928 \u092a\u0922\u093c\u093e\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f \u0927\u0928\u094d\u092f\u0935\u093e\u0926! \u0915\u0943\u092a\u092f\u093e \u0907\u0938 \u092b\u0949\u0930\u094d\u092e \u0915\u093e \u0909\u092a\u092f\u094b\u0917 \u0905\u092a\u0928\u0947 \u0935\u0940\u0921\u093f\u092f\u094b \u0915\u093e \u0935\u093f\u0935\u0930\u0923 \u092a\u094d\u0930\u0938\u094d\u0924\u0941\u0924 \u0915\u0930\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f \u0915\u0930\u0947\u0902\u0964"),r.a.createElement("p",{className:"lead"},"Namaste, friends. Thank you for teaching online with Turn the Bus! Please use this form to submit the details of your video."),r.a.createElement("p",{className:"lead"},r.a.createElement(F.a,{variant:"link",href:"https://www.turnthebus.org/",target:"_blank"},"\ud83c\udf10 turnthebus.org")))))},A=a(299),U=function(e){var t=e.spinning,a=e.label;return t&&r.a.createElement(r.a.Fragment,null,a," ",r.a.createElement(A.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}))},D=a(58),M=a.n(D),R=a(88),q=function(){var e=Object(R.a)(M.a.mark((function e(t){var a,n,r,l,o,i;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.fetchUrlObj,n=t.method,r=void 0===n?"GET":n,l=t.body,o=t.tableName,i=void 0===o?"":o,e.abrupt("return",new Promise((function(e,t){var n=x.getAuthToken();x.getUsername();n||(console.error("No auth token"),t({})),a||(console.error("No or invalid url"),t({}));try{var o={"Content-Type":"application/json",crossdomain:!0,dataType:"json",headers:new Headers({Authorization:n})};"GET"!==r?(o.method="POST",o.body=JSON.stringify(l)):i&&a.searchParams.append("tableName",i),e(fetch(a,o).then((function(e){return e.json()})))}catch(c){console.error("error fetching response",c),t({})}})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(e){var t=e.pre,a=void 0===t?function(){}:t,n=e.tableName,r=e.query,l=e.validator,o=e.victory,i=e.defeat;a();var c=new URL("".concat(s.api.invokeUrl,"/scantable"));r&&Object.keys(r).forEach((function(e){c.searchParams.append(e,r[e])})),q({fetchUrlObj:c,tableName:n}).then((function(e){l(e)?o(null===e||void 0===e?void 0:e.result):i()}),(function(e){i(e)}))},V=function(e){var t=e.pre,a=void 0===t?function(){}:t,n=e.resource,r=void 0===n?"getsignedurl":n,l=e.dataValues,o=e.validator,i=e.victory,c=e.defeat;try{a();var u=x.getAuthToken();u||(console.error("No auth token"),c("No auth token"));var d=new URL("".concat(s.api.invokeUrl,"/").concat(r));d.searchParams.append("bucket",s.videoBucket),Object.keys(l).forEach((function(e){d.searchParams.append(e,l[e])})),fetch(d,{crossdomain:!0,contentType:"application/json",dataType:"json",headers:new Headers({Authorization:u})}).then((function(e){return e.json()})).then((function(e){o(e)?i(e):c(e)}))}catch(m){console.error("Error getting video upload URL!"),c(m)}},G=a(470),_=a(1022),H=a(14),J=a(1018),K=a(1019),W=a(104),Y=(a(497),function(e){return e.replace("@","-at-")}),X=function(e,t){var a=[];null===e||void 0===e||e.forEach((function(e){a[e[t]]=""}));return Object.keys(a)},Z=function(e){var t=e.controlType,a=e.controlProps,n=e.required,l=e.selectFrom;switch(t){case"select":return r.a.createElement(H.a.Control,Object.assign({},a,{as:t,required:n}),l&&function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t?[r.a.createElement("option",{key:"empty-option",value:""},"Please select")]:[];return e.forEach((function(e){a.push(r.a.createElement("option",{key:e,value:e},e))})),r.a.createElement(r.a.Fragment,null,a)}(l));case"file":return r.a.createElement(H.a.File,Object.assign({},a,{required:n}));default:return r.a.createElement(H.a.Control,Object.assign({},a,{as:t,required:n}))}},$=function(e){var t=e.horizontal,a=e.displayName,n=e.required,l=e.id,o=e.controlType,i=e.selectFrom,c=e.helpText,s=e.learnMore,d=(e.touched,e.errors),m=Object(u.a)(e,["horizontal","displayName","required","id","controlType","selectFrom","helpText","learnMore","touched","errors"]),f={};return t&&(f.as=T.a),r.a.createElement(H.a.Group,Object.assign({controlId:l},f),r.a.createElement(H.a.Label,null,a),n&&r.a.createElement("span",{className:"red"},"*"),Z({controlType:o,controlProps:m,required:n,selectFrom:i}),d&&d[m.name]?r.a.createElement(H.a.Control.Feedback,{type:"invalid"},d[m.name]):"",r.a.createElement(H.a.Text,{muted:!0},"function"===typeof c?c():c||"",s?r.a.createElement(r.a.Fragment,null," ",r.a.createElement("a",{target:"_blank",href:s},"Learn more")):""))},Q=function(e){return r.a.createElement($,Object.assign({},e,{controlType:"select"}))},ee=function(e){return r.a.createElement($,Object.assign({},e,{controlType:"file"}))},te=function(e){var t=e.fields,a=e.handleChange,n=e.horizontal,l=void 0!==n&&n,o=e.values,i=Object(u.a)(e,["fields","handleChange","horizontal","values"]);return(null===t||void 0===t?void 0:t.length)?t.map((function(e,t){switch(null===e||void 0===e?void 0:e.type){case"select":return function(e,t,a,n,l){var o=e.fieldName,i=e.formFieldId,c=e.values,s=Object(u.a)(e,["fieldName","formFieldId","values"]);return o&&i&&c?r.a.createElement(Q,Object.assign({},s,{key:"".concat(i,"-").concat(t),displayName:o,id:i,name:i,value:a[i],onChange:n,selectFrom:null===c||void 0===c?void 0:c.split(",")})):"Error rendering select field."}(Object(y.a)({horizontal:l},e),t,o,a);case"file":return function(e,t,a,n,l){var o=e.fieldName,i=e.formFieldId,c=Object(u.a)(e,["fieldName","formFieldId"]);return o&&i?r.a.createElement(ee,Object.assign({},l,c,{key:"".concat(i,"-").concat(t),displayName:o,id:i,name:i,value:a[i],onChange:n})):"Error rendering file field"}(Object(y.a)({horizontal:l},e),t,o,a,i);default:return function(e,t,a,n,l){var o=e.type,i=e.fieldName,c=e.formFieldId,s=Object(u.a)(e,["type","fieldName","formFieldId"]);return i&&c&&o?r.a.createElement($,Object.assign({},l,s,{key:"".concat(c,"-").concat(t),controlType:o,displayName:i,id:c,name:c,value:a[c],onChange:n})):"Error rendering field"}(Object(y.a)({horizontal:l},e),t,o,a,i)}})):"No Fields to render."},ae=function(e){var t=1e3*e,a=Math.floor(t/1e3/60/60)%24,n=Math.floor(t/1e3/60)%60,r=Math.floor(t/1e3)%60,l=[];return a>0&&l.push("".concat(a," hours")),n>0&&l.push("".concat(n," minutes")),r>0&&l.push("".concat(r," seconds")),l.length?l.join(", ")+" remaining":""},ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var a=0>t?0:t,n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(a))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]},re=function(e){var t=e.spinning,a=e.label,n=Object(u.a)(e,["spinning","label"]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(F.a,Object.assign({disabled:t},n),t?r.a.createElement(U,{spinning:t,label:a}):a))},le=W.b().shape({tutorName:W.c().required("Please provide a tutor name."),chapterName:W.c().required("Please provide a chapter name."),chapterNumber:W.c().required("Please provide a chapter number."),chapterPart:W.c().required("Please provide a chapter part."),title:W.c().required("Please provide a video title."),file:W.a().required("Please provide an mp4 file.")}),oe=function(e){var t,a,l,o,i=e.formData,c=i.bookData,s=i.videoData,m=Object(n.useState)(null===c||void 0===c?void 0:c.Items),f=Object(d.a)(m,2),v=f[0],p=f[1],g=Object(n.useState)("English"),E=Object(d.a)(g,2),h=E[0],O=E[1],j=Object(n.useState)("English"),k=Object(d.a)(j,2),S=k[0],N=k[1],w=Object(n.useState)(!1),P=Object(d.a)(w,2),C=P[0],x=P[1],T=Object(n.useState)(0),L=Object(d.a)(T,2),I=L[0],B=L[1],A=Object(n.useState)(0),U=Object(d.a)(A,2),D=U[0],M=U[1],R=Object(n.useState)(0),q=Object(d.a)(R,2),z=q[0],W=q[1],Y=Object(n.useState)(),Z=Object(d.a)(Y,2),$=Z[0],ee=Z[1],oe=Object(n.useState)(),ie=Object(d.a)(oe,2),ce=ie[0],se=ie[1],ue=Object(n.useState)(!1),de=Object(d.a)(ue,2),me=de[0],fe=de[1],ve=Object(n.useState)(),pe=Object(d.a)(ve,2),be=pe[0],ge=pe[1],Ee=Object(n.useState)(!1),he=Object(d.a)(Ee,2),Oe=he[0],je=he[1],ye=Object(n.useState)(!1),ke=Object(d.a)(ye,2),Se=ke[0],Ne=ke[1],we=Object(n.useState)(!1),Pe=Object(d.a)(we,2),Ce=Pe[0],xe=Pe[1],Te=Object(n.useState)(!1),Fe=Object(d.a)(Te,2),Le=Fe[0],Ie=Fe[1],Be=Object(n.useRef)(),Ae=(null===s||void 0===s||null===(t=s.Items)||void 0===t?void 0:t.filter((function(e){return"CLASS_INFO"===e.section})))||[],Ue=(null===s||void 0===s||null===(a=s.Items)||void 0===a?void 0:a.filter((function(e){return"TUTOR_INFO"===e.section})).sort((function(e,t){return e.order-t.order})))||[],De=(null===s||void 0===s||null===(l=s.Items)||void 0===l?void 0:l.filter((function(e){return"BOOK_INFO"===e.section})).sort((function(e,t){return e.order-t.order})))||[],Me=(null===s||void 0===s||null===(o=s.Items)||void 0===o?void 0:o.filter((function(e){return"VIDEO_INFO"===e.section})).sort((function(e,t){return e.order-t.order})))||[],Re=function(e,t,a){return a&&t?null===a||void 0===a?void 0:a.filter((function(a){return a[e]===t})):a||[]},qe=function(e){return Re("SUBJECT",e,null===c||void 0===c?void 0:c.Items)},ze=function(e,t){var a=function(e,t){return Re("LANGUAGE",t,qe(e))}(e,t);return(null===a||void 0===a?void 0:a.length)?a:qe(e)},Ve=function(e,t){return X(e,t)[0]};Object(n.useEffect)((function(){p(ze(h,S))}),[h,S]);var Ge=X(qe(h),"LANGUAGE"),_e=X(v,"BOOK_NAME"),He={tutorName:"",subject:h,bookLanguage:Ge[0],bookName:_e[0]},Je=function(){Be&&Be.current&&Be.current.reset()},Ke=function(e,t,a){if(a&&e.get("file")&&e.get("file").name){je(!0);var n=new XMLHttpRequest;n.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);W(e.total),M(e.loaded),B(t)}}),!1),n.open("POST",a.url),n.overrideMimeType("text/plain; charset=x-user-defined-binary"),n.onreadystatechange=function(){n.readyState!==XMLHttpRequest.DONE||200!==n.status&&204!==n.status?n.readyState!==XMLHttpRequest.HEADERS_RECEIVED&&console.error("POST: Server response error. Please check console/network logs."):function(e){e?V({pre:function(){},resource:"updatevideometadata",dataValues:e,validator:function(){return!0},victory:function(){je(!1),fe(!0),x(!1),Je()},defeat:function(e){ee("POST: Could not update video data. Please check console/network logs.")}}):ee("Sever Error: Unknown uploaded filename. Please check console/network logs.")}(t)},n.send(e),xe(n),Ie(new Date)}else!a&&ee("Server Error!")},We=function(){var e=new Date-Le,t=D/(e/1e3);return{eta:ae((z-D)/t),uploadSpeed:Math.round(t/1e3)}}(),Ye=We.eta,Xe=We.uploadSpeed;return r.a.createElement("div",null,r.a.createElement(_.a,{show:Oe,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0},r.a.createElement(_.a.Header,null,r.a.createElement(_.a.Title,{id:"contained-modal-title-vcenter"},"Uploading (",Xe," KB/s)")),r.a.createElement(_.a.Body,null,r.a.createElement("div",null,r.a.createElement("span",{id:"uploadDataDone"}),r.a.createElement("span",{id:"uploadDataTotal"},ne(D)," / ",ne(z)),r.a.createElement("br",null),r.a.createElement("small",null,Ye),r.a.createElement("div",{id:"uploadProgressBarCtr",class:"progress"},r.a.createElement("span",{id:"uploadProgressValue"},"".concat(I,"%")),r.a.createElement("div",{id:"uploadProgressBar",class:"progress-bar",style:{width:"".concat(I,"%")},role:"progressbar","aria-valuenow":I,"aria-valuemin":"0","aria-valuemax":"100"},"\xa0")),r.a.createElement("small",null,(null===be||void 0===be?void 0:be.key)||"No File"))),r.a.createElement(_.a.Footer,null,r.a.createElement(F.a,{onClick:function(e){Ce&&(Ce.abort(),se("Upload canceled!")),je(!1)}},"Close"))),r.a.createElement("h1",null,"Video Upload"),r.a.createElement("br",null),r.a.createElement("p",null,"Fields marked with a red asterisk (",r.a.createElement("span",{className:"red"},"*"),") are required fields. Please provide a valid value for these."),r.a.createElement("p",null,"\u0924\u093e\u0930\u093e\u0902\u0915\u0928 \u091a\u093f\u0939\u094d\u0928 (",r.a.createElement("span",{className:"red"},"*"),") \u0915\u0947 \u0938\u093e\u0925 \u091a\u093f\u0939\u094d\u0928\u093f\u0924 \u092a\u094d\u0930\u0936\u094d\u0928 \u0905\u0928\u093f\u0935\u093e\u0930\u094d\u092f \u0939\u0948\u0902\u0964"),r.a.createElement(G.a,{initialValues:He,onSubmit:function(e,t){var a=t.setSubmitting;Ne(!0),le.isValid(e).then((function(t){if(t){var a=document.querySelector("#file"),n=a&&a.files&&a.files[0],r=n&&n.name;if(r){e.file;var l=Object(u.a)(e,["file"]),o=Object(y.a)({key:r},l);ge(o),V({dataValues:o,validator:function(){return!0},victory:function(e){var t=e.signedURL,a=new FormData;Object.keys(t.fields).forEach((function(e){a.append(e,t.fields[e])})),a.append("file",n),Ne(!1),Ke(a,o,t)},defeat:function(e){console.error(e),ee("Failed to upload!")}})}else ee("No file!")}}),(function(e){console.error(e),ee("Failed to upload!")})),a(!1)},validationSchema:le},(function(e){var t=e.errors,a=e.handleChange,n=e.handleReset,l=e.handleSubmit,o=e.touched,i=e.values;return r.a.createElement(H.a,{validated:C,noValidate:!0,ref:Be},r.a.createElement("h2",null,"Tutor Information"),te({errors:t,fields:Ue,handleChange:a,touched:o,values:i}),r.a.createElement("h2",null,"Class Information"),r.a.createElement(H.a.Row,null,te({errors:t,fields:Ae,handleChange:a,horizontal:!0,touched:o,values:i})),r.a.createElement("h2",null,"Book Information"),r.a.createElement(H.a.Row,null,r.a.createElement(Q,{horizontal:!0,displayName:"Subject",required:!0,id:"subject",name:"subject",value:i.subject,onChange:function(e){var t,n=null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value;i.bookLanguage=Ve(qe(n),"LANGUAGE"),i.bookName=Ve(ze(n,i.bookLanguage),"BOOK_NAME"),O(n),N(i.bookLanguage),a(e)},selectFrom:X(null===c||void 0===c?void 0:c.Items,"SUBJECT")}),r.a.createElement(Q,{horizontal:!0,displayName:"Book Language",required:!0,id:"bookLanguage",name:"bookLanguage",value:i.bookLanguage,onChange:function(e){var t,n;i.bookName=Ve(ze(i.subject,null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value),"BOOK_NAME"),N(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value),a(e)},selectFrom:Ge})),r.a.createElement(Q,{displayName:"Book Name",required:!0,id:"bookName",name:"bookName",value:i.bookName,onChange:a,selectFrom:_e}),te({errors:t,fields:De,handleChange:a,values:i}),r.a.createElement("h2",null,"Video Details"),te({errors:t,fields:Me,handleChange:a,values:i}),r.a.createElement(J.a,{"aria-label":"Toolbar with button groups"},r.a.createElement(K.a,{className:"mr-2","aria-label":"First group"},r.a.createElement(re,{type:"button",onClick:function(e){x(!0),l(e)},spinning:Se,label:"Upload"})),r.a.createElement(K.a,{className:"mr-2","aria-label":"Second group"},r.a.createElement(F.a,{type:"button",variant:"outline-secondary",onClick:function(e){x(!1),Je(),fe(!1),n(e)}},"clear all"))),me&&r.a.createElement(b.a,{variant:"success"},"File uploaded successfully!"),ce&&r.a.createElement(b.a,{variant:"warning"},ce),$&&r.a.createElement(b.a,{variant:"danger"},$))})))},ie=function(){var e=Object(n.useState)(!0),t=Object(d.a)(e,2),a=t[0],l=t[1],o=Object(n.useState)(!1),i=Object(d.a)(o,2),c=i[0],s=i[1],u=Object(n.useState)(!1),f=Object(d.a)(u,2),g=f[0],E=f[1],h=Object(n.useState)({}),O=Object(d.a)(h,2),j=O[0],y=O[1],k=Object(n.useState)({}),S=Object(d.a)(k,2),N=S[0],w=S[1];return Object(n.useEffect)((function(){z({pre:function(){return l(!0)},tableName:"videoMetadata",validator:function(e){var t;return(null===e||void 0===e||null===(t=e.result)||void 0===t?void 0:t.Count)>=0},victory:function(e,t,a){y(e),z({tableName:"booksMetaData",validator:function(e){var t;return(null===e||void 0===e||null===(t=e.result)||void 0===t?void 0:t.Count)>=0},victory:function(e,t,a){l(!1),w(e),s(!0)},defeat:function(){l(!1),E(!0)}})},defeat:function(){l(!1),E(!0)}})}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(B,null),r.a.createElement(v.a,{className:"upload-main-content"},r.a.createElement(p.a,null,r.a.createElement(T.a,null),r.a.createElement(T.a,{sm:12,md:8},r.a.createElement(U,{spinning:a,label:" loading video upload form"}),!a&&!g&&c&&r.a.createElement(oe,{formData:{bookData:N,videoData:j}}),r.a.createElement(b.a,{closeLabel:"dismiss alert",dismissible:!0,show:g,onClose:function(){return E(!1)},variant:"danger"},"Encountered some error getting form data. ",r.a.createElement(m.b,{to:"/login"},"Try signing in again."))),r.a.createElement(T.a,null))))},ce=a(455),se=a.n(ce),ue=a(456),de=a.n(ue),me=(a(577),a(378),function(){var e,t=Object(n.useState)(!0),a=Object(d.a)(t,2),l=a[0],o=a[1],i=Object(n.useState)(!1),c=Object(d.a)(i,2),s=c[0],u=c[1],m=Object(n.useState)(!1),f=Object(d.a)(m,2),v=f[0],p=f[1],b=Object(n.useState)([]),g=Object(d.a)(b,2),E=g[0],h=g[1];Object(n.useEffect)((function(){z({pre:function(){return o(!0)},tableName:"UploadVideo",validator:function(e){var t;return(null===e||void 0===e||null===(t=e.result)||void 0===t?void 0:t.Count)>=0},victory:function(t,a,n){e=t.Items,h(e),o(!1),p(!0)},defeat:function(){o(!1),u(!0)}})}),[]);var O={paginationSize:5,pageStartIndex:0,firstPageText:"<<",prePageText:"Back",nextPageText:">",lastPageText:">>",showTotal:!0,alwaysShowAllBtns:!0,sizePerPageList:[{text:"show 5",value:5},{text:"show 10",value:10},{text:"show 15",value:15}],onPageChange:function(e,t){console.log("page",e),console.log("sizePerPage",t)},onSizePerPageChange:function(e,t){console.log("page",e),console.log("sizePerPage",t)}};return r.a.createElement("div",{className:"App"},r.a.createElement("h3",null," Video Upload History "),r.a.createElement(U,{spinning:l,label:" loading history data"}),!l&&!s&&v&&r.a.createElement(se.a,{striped:!0,keyField:"uploadID",columns:[{dataField:"subject",text:"Subject"},{dataField:"videoTitle",text:"Video Title"},{dataField:"bookName",text:"Book Name"},{dataField:"chapterName",text:"Chapter Name"},{dataField:"chapterNumber",text:"Chapter Number"},{dataField:"chapterPart",text:"Chapter Part"},{dataField:"videoDescription",text:"Video Description"},{dataField:"tutorName",text:"Tutor Name"},{dataField:"fileName",text:"File Name"}],data:E,defaultSorted:[{dataField:"subject",order:"desc"}],pagination:de()(O),id:"historyTable"}))});var fe=function(e){e.userData;return r.a.createElement("main",{className:"flex-grow-1"},r.a.createElement(f.d,null,r.a.createElement(f.b,{path:"/upload"},r.a.createElement(ie,null)),r.a.createElement(f.b,{path:"/history"},r.a.createElement(me,null))))},ve=function(e){var t=e.userData,a=Object(f.h)(),n=t.email,l=t.name;if(!n)return r.a.createElement(b.a,{variant:"warning"},"Some error getting your data. Please ",r.a.createElement(m.b,{to:"/login"}," login again. "));var o=l&&n?"".concat(t.name,"(").concat(t.email,")"):n;return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.ToastProvider,{placement:"bottom-center"},r.a.createElement("div",{className:"d-flex flex-column app-ctr-lvl-1"},r.a.createElement(E.a,{bg:"light",expand:"sm",sticky:"top",className:"top-nav"},r.a.createElement(E.a.Brand,null,r.a.createElement(O,null)),r.a.createElement(E.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(E.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(g.a,{defaultActiveKey:"/admin",className:"mr-auto",style:{marginLeft:"auto",marginRight:"auto"}},x.isTutor()&&r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a.Link,{className:"/upload"===a.pathname?"active-top-route":"",href:"/upload"},"Upload"),r.a.createElement(g.a.Link,{className:"/history"===a.pathname?"active-top-route":"",href:"/history"},"History")),x.isAdmin()&&r.a.createElement(g.a.Item,{className:"nav-link"},r.a.createElement(m.c,{activeClassName:"active-top-route",to:"/admin"},"Administration"))),r.a.createElement(E.a.Text,null,o),r.a.createElement(g.a,null,r.a.createElement(g.a.Link,{href:"/logout"},"Sign out")))),r.a.createElement(fe,{userData:t}),r.a.createElement("footer",{style:{marginTop:"4em"},className:"ttb-container"},r.a.createElement(v.a,null,r.a.createElement(p.a,{style:{display:"block"}},"Turn the Bus is a registered 501 (c) (3) US nonprofit organization."))))))};var pe=function(e){var t=e.afterLogin,a=Object(n.useState)(""),l=Object(d.a)(a,2),o=l[0],i=l[1],s=Object(n.useState)(""),u=Object(d.a)(s,2),v=u[0],g=u[1],E=Object(n.useState)(!1),h=Object(d.a)(E,2),j=h[0],y=h[1],k=Object(n.useState)({}),S=Object(d.a)(k,2),N=S[0],P=S[1],C=Object(f.g)(),x=function(){var e=Object(R.a)(M.a.mark((function e(a){var n,r,l,i,s,u;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),!o||!v){e.next=22;break}return e.prev=2,y(!0),e.next=6,c.a.signIn(Y(o),v);case 6:i=e.sent,s=(null===i||void 0===i||null===(n=i.signInUserSession)||void 0===n||null===(r=n.idToken)||void 0===r?void 0:r.jwtToken)||"",u={email:o,name:null===i||void 0===i||null===(l=i.attributes)||void 0===l?void 0:l.name,authToken:s,showWelcomeBanner:!0},w(u),t(u),y(!1),C.push("/upload"),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(2),console.error("error signing in",e.t0),y(!1),"User is disabled."===(null===e.t0||void 0===e.t0?void 0:e.t0.message)?P({type:"warning",message:"Your account is pending activation by administrators. \ud83d\udd12"}):P({type:"danger",message:"There was an error logging in.\n                        ".concat((null===e.t0||void 0===e.t0?void 0:e.t0.message)||"","\n                        Please check console/network logs or contact administrators.")});case 20:e.next=23;break;case 22:P({type:"danger",message:"Some fields are missing"});case 23:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t){return e.apply(this,arguments)}}();return L(r.a.createElement(r.a.Fragment,null,r.a.createElement(O,null),r.a.createElement("h1",null,"Video Upload Sign-in"),r.a.createElement(p.a,{className:"h-100"},r.a.createElement(T.a,null,r.a.createElement(H.a,null,r.a.createElement(H.a.Group,{controlId:"formBasicEmail"},r.a.createElement(H.a.Label,null,"Email address"),r.a.createElement(H.a.Control,{disabled:j,type:"email",placeholder:"Enter email",value:o,onChange:function(e){return i(e.target.value)}})),r.a.createElement(H.a.Group,{controlId:"formBasicPassword"},r.a.createElement(H.a.Label,null,"Password"),r.a.createElement(H.a.Control,{disabled:j,type:"password",placeholder:"Password",onChange:function(e){return g(e.target.value)}})),r.a.createElement(re,{spinning:j,label:"Login",variant:"primary",type:"submit",onClick:function(e){return x(e)}}))),r.a.createElement(T.a,null)),r.a.createElement("br",null),(null===N||void 0===N?void 0:N.type)&&(null===N||void 0===N?void 0:N.message)&&r.a.createElement(b.a,{variant:(null===N||void 0===N?void 0:N.type)||"warning"},(null===N||void 0===N?void 0:N.message)||"Error submitting"),r.a.createElement("br",null),r.a.createElement(m.b,{to:"/register"},"Register"),r.a.createElement("br",null),r.a.createElement(m.b,{to:"/verify"},"Verify email")))},be=function(e){var t=e.afterLogout,a=Object(f.g)();return Object(n.useEffect)((function(){S.a.remove("tutor-session"),c.a.signOut(),t(N),a.push("/login")}),[a,t]),r.a.createElement("div",null,"Logging out!")};var ge=function(e){var t=e.afterRegister,a=Object(n.useState)(""),l=Object(d.a)(a,2),o=l[0],i=l[1],s=Object(n.useState)(""),u=Object(d.a)(s,2),v=u[0],p=u[1],g=Object(n.useState)(""),E=Object(d.a)(g,2),h=E[0],j=E[1],y=Object(n.useState)(""),k=Object(d.a)(y,2),S=k[0],N=k[1],w=Object(n.useState)(!1),P=Object(d.a)(w,2),C=P[0],x=P[1],T=Object(n.useState)({}),F=Object(d.a)(T,2),I=F[0],B=F[1],A=Object(f.g)(),U=function(){var e=Object(R.a)(M.a.mark((function e(a){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),!(o&&h&&S&&h===S)){e.next=18;break}return e.prev=2,x(!0),e.next=6,c.a.signUp({username:Y(o),password:h,attributes:{email:o,name:v}});case 6:x(!1),t(o),A.push("/verify"),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(2),x(!1),console.error("error signing up:",e.t0),B({type:"danger",message:"There was an error registering.\n                    ".concat((null===e.t0||void 0===e.t0?void 0:e.t0.message)+"."||!1,"\n                     Please check console/network logs or contact administrators.")});case 16:e.next=19;break;case 18:B({type:"danger",message:"Some fields are missing"});case 19:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}();return L(r.a.createElement(r.a.Fragment,null,r.a.createElement(O,null),r.a.createElement("h1",null,"Register"),r.a.createElement(H.a,null,r.a.createElement(H.a.Group,{controlId:"name"},r.a.createElement(H.a.Label,null,"Name"),r.a.createElement(H.a.Control,{disabled:C,type:"text",placeholder:"Enter your name",value:v,onChange:function(e){return p(e.target.value)}})),r.a.createElement(H.a.Group,{controlId:"email"},r.a.createElement(H.a.Label,null,"Email address"),r.a.createElement(H.a.Control,{disabled:C,type:"email",placeholder:"Enter email",value:o,onChange:function(e){return i(e.target.value)}})),r.a.createElement(H.a.Group,{controlId:"pass"},r.a.createElement(H.a.Label,null,"Password"),r.a.createElement(H.a.Control,{disabled:C,type:"password",placeholder:"Password",onChange:function(e){return j(e.target.value)}}),r.a.createElement("small",{id:"titleHelpBlock",className:"form-text text-muted"},"Minimum length: 8",r.a.createElement("br",null),"At least 1 numerical character",r.a.createElement("br",null),"At least 1 special character",r.a.createElement("br",null),"At least 1 uppercase character",r.a.createElement("br",null),"At least 1 lowercase character",r.a.createElement("br",null))),r.a.createElement(H.a.Group,{controlId:"pass2"},r.a.createElement(H.a.Label,null,"Re enter password"),r.a.createElement(H.a.Control,{disabled:C,type:"password",placeholder:"Re enter Password",onChange:function(e){return N(e.target.value)}})),r.a.createElement(re,{spinning:C,label:"Register",variant:"primary",type:"submit",onClick:function(e){return U(e)}})),r.a.createElement("br",null),(null===I||void 0===I?void 0:I.type)&&(null===I||void 0===I?void 0:I.message)&&r.a.createElement(b.a,{variant:(null===I||void 0===I?void 0:I.type)||"warning"},(null===I||void 0===I?void 0:I.message)||"Error submitting"),r.a.createElement(m.b,{to:"/verify"},"Verify email"),r.a.createElement("br",null),r.a.createElement(m.b,{to:"/login"},"Login")))};var Ee=function(e){var t=e.stickyEmail,a=Object(n.useState)(t||""),l=Object(d.a)(a,2),o=l[0],i=l[1],s=Object(n.useState)(""),u=Object(d.a)(s,2),f=u[0],v=u[1],p=Object(n.useState)(!1),g=Object(d.a)(p,2),E=g[0],h=g[1],j=Object(n.useState)({}),y=Object(d.a)(j,2),k=y[0],S=y[1],N=function(){var e=Object(R.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!o||!f){e.next=17;break}return e.prev=2,h(!0),e.next=6,c.a.confirmSignUp(Y(o),f);case 6:h(!1),S({type:"success",message:"\u2705 Your account has been verified. Please wait for admins to enable your account."}),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),console.error("error verifying:",e.t0),h(!1),S({type:"danger",message:"There was an error verifying your account.\n                    ".concat((null===e.t0||void 0===e.t0?void 0:e.t0.message)||"","\n                    Please check console/network logs or contact administrators.")});case 15:e.next=18;break;case 17:S({type:"danger",message:"Some fields are missing"});case 18:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}();return L(r.a.createElement(r.a.Fragment,null,r.a.createElement(O,null),r.a.createElement("h1",null,"Email Verification"),r.a.createElement("p",null,"We have sent an email with the verification code to your registered email address. \ud83d\udcec"),r.a.createElement(H.a,null,r.a.createElement(H.a.Group,{controlId:"email"},r.a.createElement(H.a.Label,null,"Email address"),r.a.createElement(H.a.Control,{disabled:E,type:"email",placeholder:"Enter email",value:o,onChange:function(e){return i(e.target.value)}})),r.a.createElement(H.a.Group,{controlId:"code"},r.a.createElement(H.a.Label,null,"Verification Code"),r.a.createElement(H.a.Control,{disabled:E,type:"text",placeholder:"Enter the code sent to your email address",value:f,onChange:function(e){return v(e.target.value)}})),r.a.createElement(re,{spinning:E,label:"Verify Email",variant:"primary",type:"submit",onClick:function(e){return N(e)}})),r.a.createElement("br",null),(null===k||void 0===k?void 0:k.type)&&(null===k||void 0===k?void 0:k.message)&&r.a.createElement(b.a,{variant:(null===k||void 0===k?void 0:k.type)||"warning"},(null===k||void 0===k?void 0:k.message)||"Error submitting"),r.a.createElement("br",null),r.a.createElement(m.b,{to:"/login"},"Login"),r.a.createElement("br",null),r.a.createElement(m.b,{to:"/register"},"Register")))},he=function(e){var t=e.children,a=Object(u.a)(e,["children"]);return r.a.createElement(f.b,Object.assign({},a,{render:function(e){var a=e.location;return x.isAuthenticated()?t:r.a.createElement(f.a,{to:{pathname:"/login",state:{from:a}}})}}))},Oe=function(){var e=Object(n.useState)(P()),t=Object(d.a)(e,2),a=t[0],l=t[1],o=Object(n.useState)(),i=Object(d.a)(o,2),c=i[0],s=i[1];return r.a.createElement(m.a,null,r.a.createElement(f.d,null,r.a.createElement(f.b,{exact:!0,path:"/login"},r.a.createElement(pe,{afterLogin:l})),r.a.createElement(f.b,{exact:!0,path:"/register"},r.a.createElement(ge,{afterRegister:s})),r.a.createElement(f.b,{exact:!0,path:"/verify"},r.a.createElement(Ee,{stickyEmail:c})),r.a.createElement(f.b,{exact:!0,path:"/logout"},r.a.createElement(be,{afterLogout:l})),r.a.createElement(he,{path:"/*"},r.a.createElement(ve,{userData:a}))))};a(967);i.default.configure({Auth:s.cognito}),c.a.configure();var je=function(){return r.a.createElement(Oe,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(991);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(je,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[480,1,2]]]);
//# sourceMappingURL=main.bb2fbb74.chunk.js.map